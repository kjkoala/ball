(()=>{"use strict";var i={p:""};const e="ArrowDown",s="ArrowUp",t="ArrowLeft",h="ArrowRight",a=[e,s,t,h,"Enter"];class m{constructor(){this.keys=new Set,window.addEventListener("keydown",(i=>{a.includes(i.key)&&!this.keys.has(i.key)&&this.keys.add(i.key)})),window.addEventListener("keyup",(i=>{a.includes(i.key)&&this.keys.delete(i.key)}))}}const r=i.p+"img/ff9475fb4e1003ea33cc.png",l=i.p+"img/38759158159257bf1c21.png",n={minX:1,maxX:13,minY:4,maxY:11,blockedSpaces:["7x4","8x6","9x6","10x6","4x7","5x7","6x7","7x9","8x9","9x9","12x10","1x11"]};class x{constructor(i,e){this.game=i,this.image=new Image,this.image.src=r,this.shadowImage=new Image,this.shadowImage.src=l,this.frameSize=16,this.frameX=0,this.frameY=0,this.x=n.minX+2,this.y=n.minY,this.pixelX=this.game.cubeSize*this.x+this.frameSize,this.pixelY=this.game.cubeSize*this.y+this.frameSize,this.movingPixelsX=this.game.cubeSize*this.x+this.frameSize,this.movingPixelsY=this.game.cubeSize*this.y+this.frameSize,this.playerName=e,this.playerNameWidth=0}update(i){this.move(i),this.pixelX<this.movingPixelsX?this.pixelX+=this.game.speed:this.pixelX>this.movingPixelsX&&(this.pixelX-=this.game.speed),this.pixelY<this.movingPixelsY?this.pixelY+=this.game.speed:this.pixelY>this.movingPixelsY&&(this.pixelY-=this.game.speed)}move(i){i.keys.has(h)&&this.pixelX===this.movingPixelsX&&(this.checkCollision("x",this.x+1),this.frameX=this.frameSize),i.keys.has(t)&&this.pixelX===this.movingPixelsX&&(this.checkCollision("x",this.x-1),this.frameX=0),i.keys.has(e)&&this.pixelY===this.movingPixelsY&&this.checkCollision("y",this.y+1),i.keys.has(s)&&this.pixelY===this.movingPixelsY&&this.checkCollision("y",this.y-1)}checkCollision(i,e){if(n.blockedSpaces.includes("x"===i?`${e}x${this.y}`:`${this.x}x${e}`))return!1;"x"===i&&e<=n.maxX&&e>=n.minX&&(this.movingPixelsX=this.game.cubeSize*e+this.frameSize,this.x=e),"y"===i&&e<=n.maxY&&e>=n.minY&&(this.movingPixelsY=this.game.cubeSize*e+this.frameSize,this.y=e)}draw(i){this.playerNameWidth||(this.playerNameWidth=i.measureText(this.playerName).width),i.fillText(this.playerName,this.pixelX-.5*this.playerNameWidth,this.pixelY),i.drawImage(this.image,this.frameX,this.frameY,this.frameSize,this.frameSize,this.pixelX,this.pixelY,this.frameSize,this.frameSize),i.drawImage(this.shadowImage,this.pixelX,this.pixelY+10)}}const o=document.createElement("canvas"),p=o.getContext("2d");document.body.append(o);const c=new class{constructor(i,e){this.width=i,this.height=e,this.speed=3,o.width=i,o.height=e,this.fps=60,this.frameInterval=1e3/this.fps,this.frameTimer=0,this.cubeSize=48,this.keys=new m,this.player=new x(this,"СУПЕР ЖОРИК 2000!")}update(){this.player.update(this.keys)}draw(i){this.player.draw(i)}}(720,624);let d=0;!function i(e){const s=e-d;d=e,c.frameTimer>c.frameInterval?(c.frameTimer=0,p.clearRect(0,0,c.width,c.height),c.update(),c.draw(p)):c.frameTimer+=s,requestAnimationFrame(i)}(d)})();